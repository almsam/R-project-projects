---
title: "Data 405 Assignment 2 2025W"
output:
  pdf_document: default
  html_document: default
date: "2025-10-21"
---


# Data 405 Assignment 2

## Q1a code:

```{r}

set.seed(12345)
n <- 10000
lambdas <- c(5, 25, 125, 625)

sim_results <- data.frame(lambda = lambdas, E_X = NA_real_, E_sqrtX = NA_real_, Var_sqrtX = NA_real_, Var_X = NA_real_)

for (i in seq_along(lambdas)) {
    lam <- lambdas[i]
    P <- rpois(n, lambda = lam)
    sim_results$E_X[i]       <- mean(P)
    sim_results$E_sqrtX[i]   <- mean(sqrt(P))
    sim_results$Var_sqrtX[i] <- var(sqrt(P))
    sim_results$Var_X[i]     <- var(P)
}

print(sim_results)


```

## Q1b discussion:

Taking the sqrt compresses larger counts and reduces the dependence of variance on the mean. This is called 'variance stabilization' for count data — after transformation the variance becomes roughly constant across levels of the mean, - which makes many statistical methods (ANOVA, ANCoVA, & lin reg) more appropriate



## Q2a code:


since u = 1-(e^(-x^2)), we can use algebra to find x=sqrt{-ln(1-u)}

thus:

```{r}

rmyV <- function(n) {
  u <- runif(n)  # uniform rands on (0,1)
  v <- sqrt(-log(1 - u))
  return(v)
}

```


## Q2b code:

```{r}

set.seed(123)
v <- rmyV(10000)

# histogram
hist(v, breaks = 40, freq = FALSE, col = "skyblue",
     main = "Histogram of simulated V with theoretical pdf",
     xlab = "v")

# expected pdf
curve(2 * x * exp(-x^2), from = 0, to = max(v), add = TRUE, col = "red", lwd = 2)
legend("topright", legend = c("Simulated", "Theoretical PDF"),
       col = c("skyblue", "red"), lwd = c(10, 2), bty = "n")

# this should be = d/dx f(x)


```



## Q3a discussion:

F(x) = int(0, x)(3t^2)dt = t^3 (0, x) = x^3


## Q3b code:

inverse func: instead of u = x^(3) we use x = u^(1/3)


```{r}

rmyX <- function(n) {
  u <- runif(n)
  x <- u^(1/3)
  return(x)
}

```


E[x] = int(0, 1)(x * 3x^2)dx = 3 * int(0, 1)(x^3)dx = 3 * x^4 /4 (0, 1) = 3* 1/4 - 0 = 3/4 = 0.75



```{r}

set.seed(1)
samp <- rmyX(10000)
mean(samp)   # expect 0.75 +/-
hist(samp, prob=TRUE, breaks=40)
curve(3*x^2, from=0, to=1, add=TRUE, col="red", lwd=2)


```


0.7492406 is indeed within acceptable tolerance of expected 0.75





## Q4a discussion:

FY(y) = pFV(y) + (1−p) FX(y)

recall:

FV(y)=0 & FV(y) = 1-e^(-y^2)
FX(y)=0 & FX(y) = y^3

and thus:

FY(y) = p(1-e(-y^2)) + (1-p)y^3 when 0<y<1
& FY(y) = p(1-e(-y^2)) + (1-p) = 1 - p * e^(-y^2)

## Q4b code:


```{r}

rmyY <- function(n, p) {
  # n: number of draws
  # p: probability of selecting V
  chooseV <- rbinom(n, size = 1, prob = p)  # 1 => use V, 0 => use X
  result <- numeric(n)
  
  nV <- sum(chooseV == 1)
  nX <- n - nV
  
  if (nV > 0) result[which(chooseV == 1)] <- rmyV(nV)
  if (nX > 0) result[which(chooseV == 0)] <- rmyX(nX)
  
  return(result)
}

```




