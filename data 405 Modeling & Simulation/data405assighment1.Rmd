---
title: "data405a1"
output: pdf_document
date: "2025-9-25"
---


# Data 405 Assignment 1

## Q1 code:

```{r}

unirand <- function(n, s) {
    # moduluo & multiplier variables
    m <- 30307
    a <- 172

    x <- integer(n)   # raw sequence
    u <- numeric(n)   # normalized seq

    x[1] <- (a * s) %% m
    u[1] <- x[1] / m

    if (n > 1) {
        for (i in 2:n) {
            x[i] <- (a * x[i-1]) %% m
            u[i] <- x[i] / m
        }
    }
    return(u)
}

# s is for seed, n is for number, m is for modulo, a is for multiplier, x is for raw sequence, u is for normalized sequence

```

```{r}

# 10 uniforms using unirand1 with seed = 13
unirand(10, 13)

```

## Q1 discussion:

The maximal cycle length of a multiplicative congruential generator with moduluo m
requires that the 'a' variable be a primitive root modulo m. Since 172 is NOT a primitive root of modulo 30307,
this generator does NOT achieve maximal cycle length (which would be m-1 = 30306)

## Q2 code:

```{r}

unirand2 <- function(n, s) {
    m <- 30323
    a <- 170

    x <- integer(n)
    u <- numeric(n)

    x[1] <- (a * s) %% m
    u[1] <- x[1] / m

    if (n > 1) {
        for (i in 2:n) {
            x[i] <- (a * x[i-1]) %% m
            u[i] <- x[i] / m
        }
    }
    return(u)
}

# s is for seed, n is for number, m is for modulo, a is for multiplier, x is for raw sequence, u is for normalized sequence

```

```{r}

# 10 uniforms using unirand2 with seed = 13
unirand2(10, 42)

```

## Q2 discussion:

For maximal cycle length: 'a' must be a primitive root modulo 'm', & since 170
is not a primitive root modulo on 30323, this generator also does NOT achieve maximal cycle length

## Q3 code:

```{r}

unirand3 <- function(n, s1, s2) {
    u1 <- unirand(n, s1)
    u2 <- unirand2(n, s2)

    u <- u1 + u2 - floor(u1 + u2)  # I believe this is [0,1)
    return(u)
}

```

```{r}

# 10 uniforms using unirand3 with seed = 67
unirand3(10, 13, 9162)

```

## Q3 discussion:

When seeds are s1 = 13 and s2 = 9162, the cycle length exceeds 300000:
 - suppose m1-1 = 30306 and m2-1 = 30322 are the periods of the two individual generators,
 - the LCM will l be 459,469,266 (source https://www.calculatorsoup.com/calculators/math/lcm.php)
 - thus: cycle length >>> 300,000

The resulting numbers look to be approximately uniformly distributed on [0,1)